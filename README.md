# RFM Customer Segmentation â€“ Luqman Muhammed Kunju

**ğŸ“‹ Project Overview**

This project performs Recency, Frequency, Monetary (RFM) analysis on transactional data to segment customers and understand their value and behaviour over time.
It combines PostgreSQL + DBeaver for data cleaning and feature engineering with Python for visualisation and insight generation.

Main goals

Clean messy CSV exports and consolidate them into a single customerâ€‘level dataset.

Compute RFM metrics for every customer.

Assign businessâ€‘friendly segments (Champions, Loyal, At Risk, New, Others).

Build a small set of clear charts that answer: who brings the most revenue, who is most valuable per customer, and how recency relates to spend.

**ğŸ—‚ Data Pipeline**

Raw data

One or more CSV files with:

Customer IDs

Transaction / invoice IDs

Transaction dates

Revenue / amount fields

ğŸ˜ PostgreSQL + DBeaver (SQL cleaning & RFM prep)
All cleaning and aggregation is done in PostgreSQL, using DBeaver:

01_create_tables.sql

Creates staging and core tables.

Defines schemas for importing raw CSV files.

02_clean_transform.sql

Cleans and standardises raw data (dates, IDs, invalid rows).

Transforms transactional data into a consistent format ready for RFM.

03_rfm_scores.sql

Calculates recency, frequency, and monetary for each customer.

Generates customerâ€‘level RFM scores or metrics.

04_segments_and_reports.sql

Applies RFM rules via CASE logic to assign segments such as Champions, Loyal, At Risk, New, Others.

Prepares summary tables / views for reporting.

The final customerâ€‘level RFM table is exported from PostgreSQL as:

text
Python/rfmdata.csv
with columns such as:

customer_id

recency

frequency

monetary

segment

These SQL scripts are provided as documentation of the endâ€‘toâ€‘end dataâ€‘engineering process.

ğŸ“ Project Structure
Your actual layout:

text
.
â”œâ”€â”€ SQL/
â”‚   â”œâ”€â”€ 01_create_tables.sql
â”‚   â”œâ”€â”€ 02_clean_transform.sql
â”‚   â”œâ”€â”€ 03_rfm_scores.sql
â”‚   â””â”€â”€ 04_segments_and_reports.sql
â”œâ”€â”€ Python/
â”‚   â”œâ”€â”€ 01_at_risk_high_value.py
â”‚   â”œâ”€â”€ 02_revenue_by_segment.py
â”‚   â”œâ”€â”€ 03_avg_value_per_segment.py
â”‚   â””â”€â”€ 04_recency_vs_spend.py
â”œâ”€â”€ Python/rfmdata.csv
â”œâ”€â”€ requirements.txt
â””â”€â”€ README.md
ğŸ§® RFM table (rfmdata.csv)
Each row in Python/rfmdata.csv represents one customer:

Column	Description
customer_id	Unique customer identifier
recency	Days since last purchase
frequency	Number of transactions
monetary	Total revenue generated by the customer
segment	RFM segment (Champions, Loyal, At Risk, â€¦)
ğŸ“Š Python Analysis & Visualisations
All analysis uses rfmdata.csv plus pandas, numpy, and matplotlib.

1ï¸âƒ£ Highâ€‘Value Atâ€‘Risk Customers â€“ 01_at_risk_high_value.py
What it does

Filters the RFM data to identify highâ€‘value â€œAt Riskâ€ customers based on segment and monetary thresholds.

Plots distributions (for example, spend distribution within the At Risk segment) to show how much revenue is concentrated in these customers.

Business question

Which highâ€‘spending customers are at risk of churning and should be prioritised for retention?

2ï¸âƒ£ Total Revenue by Segment â€“ 02_revenue_by_segment.py
What it does

Groups by segment to compute Total_Revenue for each segment.

Calculates each segmentâ€™s percentage share of total revenue.

Plots a bar chart:

â€œTotal Revenue by Customer Segmentâ€
â€“ Bar height: total revenue per segment
â€“ Label on each bar: revenue share in %

Business question

Which RFM segments drive the most overall revenue?

3ï¸âƒ£ Average Value per Segment â€“ 03_avg_value_per_segment.py
What it does

Computes the average monetary value per customer in each segment.

Visualises:

â€œAverage Monetary Value by Customer Segmentâ€
â€“ One point or bar per segment
â€“ Yâ€‘axis = average spend per customer

Business question

On average, which types of customers are most valuable individually?

4ï¸âƒ£ Recency vs Spend by Segment â€“ 04_recency_vs_spend.py
What it does

Aggregates average recency and average monetary per segment.

Plots:

â€œRecency vs Spend by Customer Segmentâ€
â€“ One series for average spend
â€“ One series for average recency (for example, on a secondary axis)

Business question

How does customer value relate to how recently each segment has purchased, and which segments are both valuable and becoming inactive?

âš™ï¸ Setup & Run Instructions
1. Clone the repository
bash
git clone <your-repo-url>
cd <your-repo-folder>
2. (Optional) Rebuild the RFM table in PostgreSQL
Create a PostgreSQL database.

Open the .sql files from the SQL/ folder in DBeaver.

Run them in order:

text
01_create_tables.sql
02_clean_transform.sql
03_rfm_scores.sql
04_segments_and_reports.sql
Export the final customerâ€‘level RFM table as rfmdata.csv into the Python/ folder.

3. Create and activate a virtual environment
bash
python -m venv .venv

# Windows:
.venv\Scripts\activate

# macOS / Linux:
source .venv/bin/activate
4. Install Python dependencies
bash
pip install -r requirements.txt
5. Run the Python analyses
From the project root:

bash
# High-value At-Risk customers
python Python/01_at_risk_high_value.py

# Total Revenue by Segment
python Python/02_revenue_by_segment.py

# Average Monetary Value per Segment
python Python/03_avg_value_per_segment.py

# Recency vs Spend by Segment
python Python/04_recency_vs_spend.py
Each script reads Python/rfmdata.csv and opens the corresponding plot window.

ğŸ“Œ Insights & Use Cases
This project shows how RFM analysis can support realâ€‘world decisions:

Revenue concentration
Understand which segments contribute most revenue overall.

Customer value
Compare average spend per customer across segments to focus on the most valuable groups.

Churn & retention
Use the Atâ€‘Risk and Recency vs Spend analyses to identify highâ€‘value customers who are going inactive, and justify targeted retention campaigns.
